<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0014)about:internet -->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"> 
    <!-- 
    Smart developers always View Source. 
    
    This application was built using Adobe Flex, an open source framework
    for building rich Internet applications that get delivered via the
    Flash Player or to desktops via Adobe AIR. 
    
    Learn more about Flex at http://flex.org 
    // -->
    <head>
        <title>${title}</title>
        <meta name="google" value="notranslate" />         
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        
        <!-- Latest compiled and minified CSS -->
		<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css">

		<!-- Optional theme -->
		<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-theme.min.css">

        
        <!-- Include CSS to eliminate any default margins/padding and set the height of the html element and 
             the body element to 100%, because Firefox, or any Gecko based browser, interprets percentage as 
             the percentage of the height of its parent container, which has to be set explicitly.  Fix for
             Firefox 3.6 focus border issues.  Initially, don't display babeliumPlayer div so it won't show 
             if JavaScript disabled.
        -->
        <style type="text/css" media="screen"> 
           /*
           html, body  { height:100%; }
            body { margin:0; padding:0; overflow:auto; text-align:center; 
                   background-color: ${bgcolor}; }  
                   */ 
            object:focus { outline:none; }
            #babeliumPlayer { display:none; }
        </style>
        
        <!-- Enable Browser History by replacing useBrowserHistory tokens with two hyphens -->
        <!-- BEGIN Browser History required section ${useBrowserHistory}>
        <link rel="stylesheet" type="text/css" href="history/history.css" />
        <script type="text/javascript" src="history/history.js"></script>
        <!${useBrowserHistory} END Browser History required section -->  
        
    </head>
    <body>
        <!-- SWFObject's dynamic embed method replaces this alternative HTML content with Flash content when enough 
             JavaScript and Flash plug-in support is available. The div is initially hidden so that it doesn't show
             when JavaScript is disabled.
        -->
        <div class="container">
        <table><tr>
        <td>
	        <div id="babeliumPlayer">
	            <p>
	                To view this page ensure that Adobe Flash Player version 
	                ${version_major}.${version_minor}.${version_revision} or greater is installed. 
	            </p>
	            <script type="text/javascript"> 
	                var pageHost = ((document.location.protocol == "https:") ? "https://" : "http://"); 
	                document.write("<a href='http://www.adobe.com/go/getflashplayer'><img src='" 
	                                + pageHost + "www.adobe.com/images/shared/download_buttons/get_flash_player.gif' alt='Get Adobe Flash player' /></a>" ); 
	            </script>
	        </div>
	        <noscript>
	            <object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="${width}" height="${height}" id="${application}">
	                <param name="movie" value="${swf}.swf" />
	                <param name="quality" value="high" />
	                <param name="bgcolor" value="${bgcolor}" />
	                <param name="allowScriptAccess" value="always" />
	                <param name="allowFullScreen" value="true" />
	                <!--[if !IE]>-->
	                <object type="application/x-shockwave-flash" data="${swf}.swf" width="${width}" height="${height}">
	                    <param name="quality" value="high" />
	                    <param name="bgcolor" value="${bgcolor}" />
	                    <param name="allowScriptAccess" value="sameDomain" />
	                    <param name="allowFullScreen" value="true" />
	                <!--<![endif]-->
	                <!--[if gte IE 6]>-->
	                    <p> 
	                        Either scripts and active content are not permitted to run or Adobe Flash Player version
	                        ${version_major}.${version_minor}.${version_revision} or greater is not installed.
	                    </p>
	                <!--<![endif]-->
	                    <a href="http://www.adobe.com/go/getflashplayer">
	                        <img src="http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif" alt="Get Adobe Flash Player" />
	                    </a>
	                <!--[if !IE]>-->
	                </object>
	                <!--<![endif]-->
	            </object>
	        </noscript>
        </td>
        <td>
         <div id="videoInfo" class="panel panel-default">
        	<div class="panel-heading">Status info</div>
        	<div class="panel-body">
	         	<p>Player mode: <span id="recorderMode">PLAYBACK</span></p>
	        	<strong>Stream 1 Info</strong>
	        	<p>Stream state: <span id="streamState">--</span></p>
	        	<p>Current Time: <span id="videoCurrentTime">--:--</span> | Duration: <span id="videoDuration">--:--</span> | Volume: <span id="volume">--</span></p>
	        	<p>Bytes Total: <span id="bytesTotal">--</span> | Start Bytes: <span id="startBytes">--</span> | Bytes Loaded: <span id="bytesLoaded">--</span></p>
	        	<strong>Stream 2 Info</strong>
	        	<p>Current Time: <span id="rightVideoCurrentTime">--:--</span> | Duration: <span id="rightVideoDuration">--:--</span></p>
	        	<p>Bytes Total: <span id="rightVideoBytesTotal">--</span> | Start Bytes: <span id="rightVideoStartBytes">--</span> | Bytes Loaded: <span id="rightVideoBytesLoaded">--</span></p>
	        	<strong>Device info</strong>
	        	<p>Device state: <span id="deviceState">Unknown</span></p>
	        	<p>Mic. activity level: <span id="micActivityLevel">--</span></p>
        	</div>
      	</div>
        </td>
        </tr>
        <tr>
        <td>
        	<div class="panel panel-default">
        		<div class="panel-heading">Controls</div>
        		<div class="panel-body">
        			<p><!-- Just to space this row from the following row -->
        			<div class="row">
        				<div class="col-lg-2"><button type="button" class="btn btn-default" onclick="playVideo();"><span class="glyphicon glyphicon-play"></span> Play</button></div>
		        		<div class="col-lg-2"><button type="button" class="btn btn-default" onclick="pauseVideo();"><span class="glyphicon glyphicon-pause"></span> Pause</button></div>
		        		<div class="col-lg-2"><button type="button" class="btn btn-default" onclick="muteVideo();"><span class="glyphicon glyphicon-volume-off"></span> Mute</button></div>
		        		<div class="col-lg-2"><button type="button" class="btn btn-default" onclick="unMuteVideo();"><span class="glyphicon glyphicon-volume-up"></span> Unmute</button></div>
		        		<div class="col-lg-2"><button type="button" class="btn btn-default" onclick="autoPlay();" data-toggle="button">Autoplay</button></div>
		        	</div>
		        	</p>
		        	<div class="row">
		        		<div class="col-lg-3">
		        			<div class="input-group">
		        				<input id="seekTo" type="text" class="form-control" />
		        					<span class="input-group-btn"><button class="btn btn-default" type="button" onclick="seekVideoTime();">Seek to</button></span>
		        			</div>
		        		</div>
		        		<div class="col-lg-4">
		        			<div class="input-group">
		        				<input id="volumeSetting" type="text" class="form-control" />
		        					<span class="input-group-btn"><button class="btn btn-default" type="button" onclick="setVideoVolume();">Set Volume</button></span>
		        			</div>
		        		</div>
	        		</div>
	        	</div>
        	</div>
        	
        	<div class="panel panel-default">
        		<div class="panel-heading">Recording</div>
        		<div class="panel-body">
		        	<form class="form-horizontal" role="form">
		        		<div class="form-group">
		        			<label for="recMethod" class="col-lg-2 control-label">Devices</label>
		        			<div class="col-lg-10">
		        				<label class="radio-inline"><input id="recmethod_0" type="radio" value="0" name="recMethod" checked="checked"/>Microphone</label>
		        				<label class="radio-inline"><input id="recmethod_1" type="radio" value="1" name="recMethod"/>Mic. and camera</label>
		        			</div>
		        		</div>
						<div class="form-group">
							<label for="recExerciseId" class="col-lg-2 control-label">Exercise</label>
							<div class="col-lg-10"><input type="text" class="form-control" id="recExerciseId" placeholder="Exercise ID or URL (empty for free recording)" value="U1MbBtkIGZQ.flv"></div>
						</div>
						<div class="form-group">
							<label for="eventDataChooser" class="col-lg-2 control-label">Event data</label>
							<div class="col-lg-10">
								<select id="eventDataChooser" class="form-control">
								    <option value="default" selected="selected"></option>
								    <option value="shaman">Shaman</option>
								    <option value="sintel">Sintel</option>
								</select>
							</div>
						</div>
						<div class="form-group">
							<label for="recordStreamUrl" class="col-lg-2 control-label">Recording URL</label>
							<div class="col-lg-10">
      							<p class="form-control-static" id="recordStreamUrl">Player returns the recording URL when you record something</p>
    						</div>
							
						</div>
						<div class="form-group">
							<div class="col-lg-offset-2 col-lg-10">
		        				<button type="button" class="btn btn-danger" onclick="recordVideo();"><span class="glyphicon glyphicon-record"></span> Record</button>
		        				<button type="button" class="btn btn-default" onclick="abortRecording();"><span class="glyphicon glyphicon-stop"></span> Stop recording</button>
		        			</div>
		        		</div>
					</form>
				</div>
			</div>
        	
        	<div class="panel panel-default">
        		<div class="panel-heading">Normal playback</div>
        		<div class="panel-body">
        			<div class="input-group">
       					<input id="loadStreamByUrl" type="text" class="form-control" placeholder="Stream URL"/>
       		 				<span class="input-group-btn"><button class="btn btn-default" type="button" onclick="loadStreamByUrl();">Load stream by url</button></span>
       				</div>
       				<div class="input-group">
       					<input id="loadStreamById" type="text" class="form-control" placeholder="Stream ID"/>
       		 				<span class="input-group-btn"><button class="btn btn-default" type="button" onclick="loadStreamById();">Load stream by id</button></span>
       				</div>
       			</div>
        	</div>
        	<div class="panel panel-default">
        		<div class="panel-heading">Side by side playback</div>
        		<div class="panel-body">
        			<form class="form-horizontal" role="form">
        				<div class="form-group">
        					<label for="leftStream" class="col-lg-2 control-label">Left stream</label>
        					<div class="col-lg-10">
        						<input type="text" class="form-control" id="leftStreamInput" placeholder="Left stream ID or URL" />
        					</div>
        				</div>
        				<div class="form-group">
        					<label for="rightStream" class="col-lg-2 control-label">Right stream</label>
        					<div class="col-lg-10">
        						<input type="text" class="form-control" id="rightStreamInput" placeholder="Right stream ID or URL" />
        					</div>
        				</div>
        				<div class="form-group">
							<label for="eventDataChooserSbs" class="col-lg-2 control-label">Event data</label>
							<div class="col-lg-10">
								<select id="eventDataChooserSbs" class="form-control">
								    <option value="default" selected="selected"></option>
								    <option value="shaman">Shaman</option>
								    <option value="sintel">Sintel</option>
								</select>
							</div>
						</div>
						<div class="form-group">
							<div class="col-lg-offset-2 col-lg-10">
								<button type="button" class="btn btn-default" onclick="loadSideBySideStreamsById();">Load side by side streams</button>
							</div>
						</div>
        			</form>
        		</div>
        	</div>
        </td>
        </tr>
        </table>
        </div>
        
        <!-- Latest compiled and minified JavaScript -->
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
		<script src="//netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
		
        <script type="text/javascript" src="swfobject.js"></script>
        <script type="text/javascript">
            // For version detection, set to min. required Flash Player version, or 0 (or 0.0.0), for no version detection. 
            var swfVersionStr = "${version_major}.${version_minor}.${version_revision}";
            // To use express install, set to playerProductInstall.swf, otherwise the empty string. 
            var xiSwfUrlStr = "${expressInstallSwf}";
            var flashvars = {"video_id":"U1MbBtkIGZQ", "language_file":"http://development/chromeless_player/player-strings-eu_ES.xml"};
            var params = {};
            params.quality = "high";
            params.bgcolor = "${bgcolor}";
            params.allowscriptaccess = "always";
            params.allowfullscreen = "true";
            var attributes = {};
            attributes.id = "${application}";
            attributes.name = "${application}";
            attributes.align = "middle";
            swfobject.embedSWF(
                "${swf}.swf", "babeliumPlayer", 
                "${width}", "${height}", 
                swfVersionStr, xiSwfUrlStr, 
                flashvars, params, attributes);
            // JavaScript enabled so display the babeliumPlayer div in case it is not replaced with a swf object.
            swfobject.createCSS("#babeliumPlayer", "display:block;text-align:left;");
        </script>
        <script type="text/javascript">
	      /*
	       * Chromeless player has no controls.
	       */
	       
	     //Get the selected role and make an object with the cuepoints
 		  var cuepoints_shaman = {
 				  'character': 'Shaman',
 				  'eventpoints': {
 					  '00:00:00.000': {
  					  	'exercise': {'action': 'volumechange', 'value': '100'},
  					  	'response': {'action': 'volumechange', 'value': '0'},
  				  	  },
 					  '00:00:02.090': {
 					  	'exercise': {'action': 'volumechange', 'value': '0'},
 					  	'response': {'action': 'volumechange', 'value': '100'},
 				  	  },
 				      '00:00:06.000': {
 				    	'exercise': {'action': 'volumechange', 'value': '100'},
 				    	'response': {'action': 'volumechange', 'value': '0'}
 				      },
 				      '00:00:10.500': {
 				    	'exercise': {'action': 'volumechange', 'value': '0'},
 				    	'response': {'action': 'volumechange', 'value': '100'},
 				      },
 				      '00:00:14.130': {
 				    	'exercise': {'action': 'volumechange', 'value': '100'},
 				    	'response': {'action': 'volumechange', 'value': '0'}
 				      },
 				      '00:00:22.880': {
 				    	'exercise': {'action': 'volumechange', 'value': '0'},
 				    	'response': {'action': 'volumechange', 'value': '100'},
 				      },
 				      '00:00:25.600': {
 				    	'exercise': {'action': 'volumechange', 'value': '100'},
 				    	'response': {'action': 'volumechange', 'value': '0'}
 				      }
					  }
 		  };
 		  
 		  var cuepoints_sintel = {
 				  'character': 'Sintel',
 				  'eventpoints': { 
 					  '00:00:07.000': {
 					  	'exercise': {'action': 'volumechange', 'value': '0'},
 					  	'response': {'action': 'volumechange', 'value': '100'},
 				  	  },
 				      '00:00:10.000': {
 				    	'exercise': {'action': 'volumechange', 'value': '100'},
 				    	'response': {'action': 'volumechange', 'value': '0'}
 				      },
 				      '00:00:17.050': {
 				    	'exercise': {'action': 'volumechange', 'value': '0'},
 				    	'response': {'action': 'volumechange', 'value': '100'},
 				      },
 				      '00:00:18.370': {
 				    	'exercise': {'action': 'volumechange', 'value': '100'},
 				    	'response': {'action': 'volumechange', 'value': '0'}
 				      },
 				      '00:00:27.240': {
 				    	'exercise': {'action': 'volumechange', 'value': '0'},
 				    	'response': {'action': 'volumechange', 'value': '100'},
 				      },
 				      '00:00:30.000': {
 				    	'exercise': {'action': 'volumechange', 'value': '100'},
 				    	'response': {'action': 'volumechange', 'value': '0'}
 				      }
					  }
 		  };
	     
	      var streamStates = {
	    		"-1": "Stream not ready",
	    		"0": "Stream ready",
	    		"1": "Stream playing",
	    		"2": "Stream stopped",
	    		"3": "Stream finished",
	    		"4": "Stream paused",
	    		"5": "Stream unpaused",
	    		"6": "Stream buffering",
	    		"7": "Stream seeking start",
	    		"8": "Stream seeking end"
	      };
	      
	      var recorderModes = {
	    		"0": "PLAYBACK",
	    		"1": "PLAY SIDE BY SIDE",
	    		"2": "RECORD MIC",
	    		"3": "RECORD MIC & WEBCAM",
	    		"4": "UPLOAD MODE"
	      };
	      
	      // Update a particular HTML element with a new value
	      function updateHTML(elmId, value) {
	        document.getElementById(elmId).innerHTML = value;
	      }
	      
	      // This function is called when an error is thrown by the player
	      function onPlayerError(errorCode) {
	        alert("An error occured of type:" + errorCode);
	      }
	      
	      // This function is called when the player changes state
	      function onPlayerStateChange(newState) {
	        updateHTML("streamState", streamStates[newState]);
	      }
	      
	      function onRecorderStateChange(newState) {
	    	  updateHTML("recorderMode", recorderModes[newState]);
	      }
	      
	      function onDeviceStateChange(newState) {
	    	  var message='';
	    	  switch (newState){
	    	  case -1:
	    		  message="Devices adm. prohibited";
	    		  break;
	    	  case 0:
	    		  message="Mic not found";
	    		  break;
	    	  case 1:
	    		  message="Camera not found";
	    		  break;
	    	  case 2:
	    		  message="Access not granted";
	    		  break;
	    	  case 3:
	    		  message="Access granted";
	    		  break;
	    	  default:
	    		  break;
	    	  }
	    	  updateHTML("deviceState",message);
	      }
	      
	      // Display information about the current state of the player
	      function updatePlayerInfo() {
	        // Also check that at least one function exists since when IE unloads the
	        // page, it will destroy the SWF before clearing the interval.
	        if(babeliumPlayer && babeliumPlayer.getDuration) {
	        	
	          updateHTML("videoDuration", ms2time(babeliumPlayer.getDuration(),0,1));
	          updateHTML("videoCurrentTime", ms2time(babeliumPlayer.getCurrentTime(),0,1));
	          updateHTML("bytesTotal", babeliumPlayer.getBytesTotal());
	          updateHTML("bytesLoaded", babeliumPlayer.getBytesLoaded());
	          
	          updateHTML("rightVideoDuration", ms2time(babeliumPlayer.getRightStreamDuration(),0,1));
	          updateHTML("rightVideoCurrentTime", ms2time(babeliumPlayer.getRightStreamCurrentTime(),0,1));
	          updateHTML("rightVideoBytesTotal", babeliumPlayer.getRightStreamBytesTotal());
	          updateHTML("rightVideoBytesLoaded", babeliumPlayer.getRightStreamBytesLoaded());
	           
	          updateHTML("micActivityLevel", babeliumPlayer.getMicActivityLevel());
	          updateHTML("volume", babeliumPlayer.getVolume());
	          
	        }
	      }
	      
	      // Allow the user to set the volume from 0-100
	      function setVideoVolume() {
	        var volume = parseInt(document.getElementById("volumeSetting").value);
	        if(isNaN(volume) || volume < 0 || volume > 100) {
	          alert("Please enter a valid volume between 0 and 100.");
	        }
	        else if(babeliumPlayer){
	        	babeliumPlayer.setVolume(volume);
	        }
	      }
	      
	      function seekVideoTime() {
	    	  var time = parseInt(document.getElementById("seekTo").value);
	    	  if(isNaN(time) || time < 0){
	    		  alert("Please enter a positive time")
	    	  } else if(babeliumPlayer){
	    		  babeliumPlayer.seekTo(time);
	    	  }
	      }
	      
	      function loadStreamByUrl(){
	    	  var url = document.getElementById("loadStreamByUrl").value;
	    	  if(babeliumPlayer)
	    	  	babeliumPlayer.loadStreamByUrl(url);
	      };
	      
	      function loadStreamById(){
	    	  var id = document.getElementById("loadStreamById").value;
	    	  if(babeliumPlayer)
	    		 babeliumPlayer.loadStreamById(id);
	      }
	      
	      function playVideo() {
	        if (babeliumPlayer) {
	        	babeliumPlayer.playVideo();
	        }
	      };
	      
	      function recordVideo(){
	    	  if (babeliumPlayer) {
	    		  //The state listener should determine when the recording is finished	    		  
	    		  
	    		  //Get the recording method
	    		  var useWebcam = 0;
	    		  var rmet = document.getElementsByName("recMethod");
	    		  var stream = document.getElementById("recExerciseId").value;
	    		  
	    		  var element = document.getElementById("eventDataChooser");
	    		  var role = element.options[element.selectedIndex].value; //if you want the label of the option instead use .text at the end
	    		  
	    		  eventData = null;
	    		  if (role == 'shaman') eventData = cuepoints_shaman;
	    		  if (role == 'sintel') eventData = cuepoints_sintel;  
	    		  
	    		  if (rmet.length > 1){
	    			  for (var i=0; i<rmet.length; i++){
	    				  if(rmet[i].checked)
	    				  	useWebcam = rmet[i].value - 0;
	    			  }
	    		  }
	    		  var recUrl = babeliumPlayer.recordStream(useWebcam, stream, eventData);
	    		  document.getElementById("recordStreamUrl").innerHTML = recUrl;
	    	  }
	      }
	      
	      function abortRecording() {
	    	  if(babeliumPlayer) {
	    		  babeliumPlayer.abortRecording();
	    	  }
	      }
	      
	      function pauseVideo() {
	        if (babeliumPlayer) {
	        	babeliumPlayer.pauseVideo();
	        }
	      }
	      
	      function muteVideo() {
	        if(babeliumPlayer) {
	        	babeliumPlayer.muteVideo();
	        }
	      }
	      
	      function unMuteVideo() {
	        if(babeliumPlayer) {
	        	babeliumPlayer.unMuteVideo();
	        }
	      }
	      
	      function autoPlay(){
	    	  
	      };
	      
	      function ms2time(milliseconds, displayHours, displayMs) {
	    	  var p_num = parseFloat(milliseconds) * 1000;
	    	  var num_ms = p_num>>0;
	    	  //Efficient integer division in js: a/b>>0
	    	  
	    	  var hours = num_ms/3600000>>0;
	    	  var minutes = (num_ms - (hours*3600000))/60000>>0;
	    	  var seconds = (num_ms - (hours*3600000) - (minutes*60000))/1000>>0;
	    	  var ms = num_ms - (hours * 3600000) - (minutes * 60000) - (seconds * 1000);
	    	  
	    	  //Format the numbers
	    	    if (hours   < 10) {hours   = "0"+hours;}
	    	    if (minutes < 10) {minutes = "0"+minutes;}
	    	    if (seconds < 10) {seconds = "0"+seconds;}
	    	    var ms_str = ms;
	    	    if (ms < 100) {ms_str = "0"+ms;}
	    	    if (ms < 10) {ms_str = "0"+ms_str;}
	    	    var time = minutes+':'+seconds;
	    	    if(displayHours)
	    	    	time = hours+':' + time;
	    	    if(displayMs)
	    	    	time = time + "." + ms_str;
	    	    
	    	    return time;
	       }
	      
	      
	      // This function is automatically called by the player once it loads
	      function onBabeliumPlayerReady(playerId) {
	    	babeliumPlayer = document.getElementById("babeliumPlayer");
	        
	        babeliumPlayer.addEventListener("onStreamStateChange", "onPlayerStateChange");
	        babeliumPlayer.addEventListener("onDeviceStateChange", "onDeviceStateChange");
	        babeliumPlayer.addEventListener("onRecorderStateChange", "onRecorderStateChange");
	        //babeliumPlayer.addEventListener("onError", "onPlayerError");

	     	// This causes the updatePlayerInfo function to be called every 250ms to
	        // get fresh data from the player
	        setInterval(updatePlayerInfo, 250);
	        updatePlayerInfo();
	      }
	      
	      // The "main method" of this sample. Called when someone clicks "Run".
	      function loadPlayer() {
	        // Lets Flash from another domain call JavaScript
	        var params = { allowScriptAccess: "always" };
	        // The element id of the Flash embed
	        var atts = { id: "ytPlayer" };
	        // All of the magic handled by SWFObject (http://code.google.com/p/swfobject/)
	        swfobject.embedSWF("http://www.youtube.com/apiplayer?" +
	                           "version=3&enablejsapi=1&playerapiid=player1",
	                           "videoDiv", "480", "295", "9", null, null, params, atts);
	      }
	      function _run() {
	        loadPlayer();
	      }
	      //google.setOnLoadCallback(_run);
    </script>
   </body>
</html>
